<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <template id="report_invoice_document_extend" name="Encabezados en Español" inherit_id="account.report_invoice_document">
            <xpath expr="//div[@class='page']" position="attributes">
                <attribute name="style">font-size:13px;</attribute>
            </xpath>
            
            <xpath expr="//th[@name='th_description']" position="replace">
                <th name="th_description" class="text-center"><span>Descripción</span></th>
            </xpath>

            <xpath expr="//th[@name='th_quantity']" position="replace">
                <th name="th_quantity" class="text-center"><span>Cantidad</span></th>
            </xpath>

            <xpath expr="//th[@name='th_priceunit']" position="replace">
                <th name="th_priceunit" t-attf-class="text-center {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Precio Unitario</span></th>
            </xpath>

            <xpath expr="//th[@name='th_price_unit']" position="replace">
                <th name="th_price_unit" t-if="display_discount" t-attf-class="text-center {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}">
                    <span>Dscto.%</span>
                </th>
            </xpath>

            <xpath expr="//th[@name='th_taxes']" position="replace">
                <th name="th_taxes" t-attf-class="text-center {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}"><span>Impuestos</span></th>
            </xpath>

            <xpath expr="//th[@name='th_subtotal']" position="replace">
                <th name="th_subtotal" class="text-center">
                    <span groups="account.group_show_line_subtotals_tax_excluded">Importe</span>
                    <span groups="account.group_show_line_subtotals_tax_included">Precio Total</span>
                </th>
            </xpath>

            <xpath expr="//i[@class='oe_form_field text-end oe_payment_label']" position="replace">
                <i class="oe_form_field text-end oe_payment_label">Pagado en <t t-out="payment_vals['date']" t-options='{"widget": "date"}'/></i>
            </xpath>
        </template>

        <template id="tax_groups_totals_extend" name="Document Tax Totals" inherit_id="account.tax_groups_totals">
            <xpath expr="//t[@t-else='']/td/span" position="replace">
                <span class="text-nowrap iva" t-out="amount_by_group['tax_group_name'].replace('VAT', 'I.V.A.')"/>
            </xpath>
        </template>

        <template id="l10n_ec_edi_report_invoice_document" name="template_name" inherit_id="l10n_ec_edi.report_invoice_document">
            <xpath expr="//th[@name='th_description']" position="replace">
                <th name="th_code" class="text-center">
                    <span>Código</span>
                </th>
            </xpath>
        </template>

        <template id="iuf_report_invoice_document" name="template_name" inherit_id="invoice_update_fields.report_invoice_note">
            <xpath expr="//div[@class='clearfix mb-4']" position="replace">
                <div class="clearfix mb-4">
                    <table class="table-val" style="width: 100%; border: transparent !important;">
                        <tr>
                            <td class="payment-additional" style="border: none !important; width: 50%;">
                                <div class="payment-method">
                                    <table class="table table-sm table-borderless" style="page-break-inside: avoid">
                                        <thead>
                                            <tr>
                                                <th class="text-center" colspan="2">Métodos de Pago</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <t t-foreach="o._l10n_ec_get_payment_data()" t-as="deta">
                                                <tr>
                                                    <td>
                                                        <span t-esc="deta['payment_name']"/>
                                                    
                                                    </td>
                                                    <td>
                                                        <span t-esc="deta['payment_total']" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                    </td>
                                                </tr>
                                            </t>
                                        </tbody>
                                    </table>
                                </div>

                            </td>
                            <td class="total" style="border: none !important; width: 50%;">
                                <div id="total" class="row">
                                    <div t-attf-class="#{'col-6' if report_type != 'html' else 'col-sm-7 col-md-6'} ms-auto">
                                        <table class="table table-sm table-borderless" style="page-break-inside: avoid;">

                                            <!--Tax totals-->
                                            <t t-set="tax_totals" t-value="o.tax_totals"/>
                                            <t t-call="account.document_tax_totals"/>

                                            <!--Payments-->
                                            <t t-if="print_with_payments">
                                                <t t-if="o.payment_state != 'invoicing_legacy'">
                                                    <t t-set="payments_vals" t-value="o.sudo().invoice_payments_widget and o.sudo().invoice_payments_widget['content'] or []"/>
                                                    <t t-foreach="payments_vals" t-as="payment_vals">
                                                        <tr t-if="payment_vals['is_exchange'] == 0">
                                                            <td>
                                                                <i class="oe_form_field text-end oe_payment_label">Pagado en <t t-out="payment_vals['date']" t-options='{"widget": "date"}'/></i>
                                                            </td>
                                                            <td class="text-end">
                                                                <span t-out="payment_vals['amount']" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                    <t t-if="len(payments_vals) > 0">
                                                        <tr class="border-black fw-bold">
                                                            <td>Importe adeudado</td>
                                                            <td class="text-end">
                                                                <span t-field="o.amount_residual"/>
                                                            </td>
                                                        </tr>
                                                    </t>
                                                </t>
                                            </t>
                                        </table>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </xpath>
        </template>

        <template id="report_invoice_header_extend" name="template_name" inherit_id="l10n_ec_edi.report_invoice_header">
            <xpath expr="//div[@style='font-size: 12px;']/strong" position="replace">
                <strong>
                    <t t-if="False" t-esc="o.company_id.partner_id.l10n_latam_identification_type_id.name" id="inv_tax_id_label"/>
                    <t>RUC/Cédula</t>:
                </strong>
            </xpath>
        </template>

    </data>
</odoo>