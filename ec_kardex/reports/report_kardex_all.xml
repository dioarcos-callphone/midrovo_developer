<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<template id="report_kardex_all">
			<t t-call="web.html_container">
			<!-- <t t-call="web.internal_layout"> -->
				<t t-set="report_title" t-value="'Kardex General'" />
				<t t-call="web.external_layout">
					<div class="page">
						<table class="table table-condensed table-bordered">
							<thead>
								<tr>
									<td class="text-left">
										<strong id="start_time_title">Desde:</strong>
									</td>
									<td class="text-left">
										<span id="start_time_value" t-esc="start_date"></span>
									</td>
									<td class="text-left">
										<strong id="end_time_title">Hasta:</strong>
									</td>
									<td class="text-left">
										<span id="end_time_value" t-esc="end_date"></span>
									</td>
								</tr>
								<tr>
									<td class="text-left">
										<strong id="location_names_title">Bodegas:</strong>
									</td>
									<td class="text-left" colspan="3">
										<span id="location_names_value" t-esc="location_ids"></span>
									</td>
								</tr>
								<tr t-if="filter_type=='by_category'">
									<td class="text-left">
										<strong id="categ_names_title">Categorias:</strong>
									</td>
									<td class="text-left" colspan="3">
										<span id="categ_names_value" t-esc="category_ids"></span>
									</td>
								</tr>
								<tr t-if="filter_type=='by_lot'">
									<td class="text-left">
										<strong id="lot_names_title">Lotes:</strong>
									</td>
									<td class="text-left" colspan="3">
										<span id="lot_names_value" t-esc="lot_ids"></span>
									</td>
								</tr>
							</thead>
						</table>
						<t t-foreach="products" t-as="product">
							<div class="row text-center">
								<strong id="product_id_value" t-esc="'Producto: %s' % product" />
							</div>
							<t t-foreach="products[product]" t-as="location_name">
								<t t-if="1==1">
									<table class="table table-condensed table-bordered">
										<thead>
											<tr>
												<td class="text-left">
													<strong id="location_id_title">Bodega</strong>
												</td>
												<td class="text-left" colspan="5">
													<span id="location_id_value" t-esc="location_name"></span>
												</td>
											</tr>
										</thead>
									</table>
									<t
										t-if="products[product][location_name]">
										<table class="table table-condensed">
											<thead>
												<tr>
													<th class="text-center" id="movimiento_title">Mov.</th>
													<th class="text-center" id="movimiento_title">Origen.</th>
													<th class="text-center" id="date_title" style="min-width: 80px;">Fecha</th>
													<th class="text-center" id="type_title">Tipo</th>
													<th class="text-center" id="product_qty_title" style="min-width: 80px;">Cant.
													</th>
													<t t-if="not env.user.has_group('inventory_report_location.group_inventory_report_location_user')">
														<th class="text-center" id="price_unit_title" style="min-width: 80px;">Costo Promedio
														</th>
													</t>
													<th class="text-center" id="inv_acum_title" style="min-width: 80px;">Inv.
														Acum.
													</th>

												</tr>
											</thead>
											<tbody>
												<tr
													t-foreach="products[product][location_name]"
													t-as="line">
													<td class="text-left">
														<span id="movimiento_value"
															t-esc="line.get('name','')[:32]"></span>
													</td>
													<td class="text-left">
														<span id="movimiento_value"
															t-esc="line.get('doc_origen', '')"></span>
													</td>
													<td class="text-left">
														<span id="date_value"
															t-esc="line.get('date','') and format_date(line['date'],lang_code='es')"></span>
													</td>
													<td class="text-left">
														 <t t-if="line.get('type','') == 'in'">
														 	<span id="type_value">ENTRADA</span>
														 </t>
														 <t t-if="line.get('type','') == 'out'">
														 	<span id="type_value">SALIDA</span>
														 </t>


														
													</td>
													<td class="text-right">
														<span id="product_qty_value"
															t-esc="formatLang(line.get('qty',0.0), dp='Product Unit of Measure')" />
													</td>
													<t t-if="not env.user.has_group('inventory_report_location.group_inventory_report_location_user')">
														<td class="text-right">
															<span id="price_unit_value"
																t-esc="formatLang(line.get('average_price',0.0), currency_obj=currency_id)" />
														</td>
													</t>
													<td class="text-right">
														<span id="inv_acum_value"
															t-esc="formatLang(line.get('inventory_value',0.0), dp='Product Unit of Measure')" />
													</td>

												</tr>

											</tbody>
										</table>
									</t>
								</t>
							</t>
						</t>
						<br/>
						<table width="100%" border="0">
							<tr>
								<th scope="col">
									<div id="revisador_por_title" align="center">___________________</div>
								</th>
								<th scope="col">
									<div id="aprobado_por_title" align="center">___________________</div>
								</th>
							</tr>
							<tr>
								<td style="vertical-align:top">
									<div id="revisador_por_value" align="center">Revisado Por:</div>
								</td>
								<td style="vertical-align:top">
									<div id="aprobado_por_value" align="center">Aprobado Por:</div>
								</td>
							</tr>
						</table>
					</div>
				</t>
			<!-- </t> -->
			</t>
		</template>

	</data>
</odoo>
